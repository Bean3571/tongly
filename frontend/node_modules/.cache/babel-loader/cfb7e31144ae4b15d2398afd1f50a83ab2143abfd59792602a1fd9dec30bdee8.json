{"ast":null,"code":"var _jsxFileName = \"C:\\\\Custom\\\\Coding\\\\tongly-basic\\\\tongly-basic\\\\frontend\\\\src\\\\pages\\\\Profile.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useNotification } from '../contexts/NotificationContext';\nimport { api } from '../api/client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const Profile = () => {\n  _s();\n  const {\n    user,\n    refreshUser\n  } = useAuth();\n  const {\n    showNotification\n  } = useNotification();\n  const [isEditing, setIsEditing] = useState(false);\n  const fileInputRef = useRef(null);\n  const [avatarPreview, setAvatarPreview] = useState(null);\n  const [formData, setFormData] = useState({\n    first_name: (user === null || user === void 0 ? void 0 : user.first_name) || '',\n    last_name: (user === null || user === void 0 ? void 0 : user.last_name) || '',\n    email: (user === null || user === void 0 ? void 0 : user.email) || '',\n    age: (user === null || user === void 0 ? void 0 : user.age) || '',\n    gender: (user === null || user === void 0 ? void 0 : user.gender) || 'not_selected'\n  });\n  if (!user) {\n    return null;\n  }\n  const handleAvatarClick = () => {\n    var _fileInputRef$current;\n    (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n  };\n  const handleAvatarChange = async e => {\n    var _e$target$files;\n    const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n    if (!file) return;\n\n    // Validate file type\n    if (!file.type.startsWith('image/')) {\n      showNotification('error', 'Please select an image file');\n      return;\n    }\n\n    // Validate file size (max 5MB)\n    if (file.size > 5 * 1024 * 1024) {\n      showNotification('error', 'Image size should be less than 5MB');\n      return;\n    }\n    try {\n      // Create preview\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setAvatarPreview(reader.result);\n      };\n      reader.readAsDataURL(file);\n\n      // Create form data\n      const formData = new FormData();\n      formData.append('file', file);\n\n      // Get token\n      const token = localStorage.getItem('token');\n      if (!token) {\n        throw new Error('No authentication token found');\n      }\n\n      // Upload avatar\n      const response = await fetch(`${process.env.REACT_APP_API_URL || 'http://localhost:8080'}/api/profile/avatar`, {\n        method: 'POST',\n        body: formData,\n        credentials: 'include',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      let responseText = await response.text();\n      if (!response.ok) {\n        try {\n          const errorData = JSON.parse(responseText);\n          throw new Error(errorData.error || 'Failed to upload avatar');\n        } catch (e) {\n          throw new Error(responseText || 'Failed to upload avatar');\n        }\n      }\n      await refreshUser();\n      showNotification('success', 'Avatar updated successfully!');\n    } catch (error) {\n      console.error('Failed to upload avatar:', error);\n      showNotification('error', error instanceof Error ? error.message : 'Failed to upload avatar. Please try again.');\n      setAvatarPreview(null);\n    }\n  };\n  const validateForm = () => {\n    if (!formData.email.trim()) {\n      showNotification('error', 'Email is required');\n      return false;\n    }\n    if (!formData.email.includes('@')) {\n      showNotification('error', 'Please enter a valid email address');\n      return false;\n    }\n    if (formData.age && (parseInt(formData.age.toString()) < 13 || parseInt(formData.age.toString()) > 120)) {\n      showNotification('error', 'Age must be between 13 and 120');\n      return false;\n    }\n    return true;\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!validateForm()) {\n      return;\n    }\n    try {\n      const updateData = {\n        first_name: formData.first_name.trim() || null,\n        last_name: formData.last_name.trim() || null,\n        email: formData.email.trim(),\n        age: formData.age ? parseInt(formData.age.toString()) : null,\n        gender: formData.gender || null,\n        // Preserve existing arrays from user data\n        languages: (user === null || user === void 0 ? void 0 : user.languages) || [],\n        interests: (user === null || user === void 0 ? void 0 : user.interests) || [],\n        learning_goals: (user === null || user === void 0 ? void 0 : user.learning_goals) || [],\n        native_language: (user === null || user === void 0 ? void 0 : user.native_language) || null,\n        survey_complete: (user === null || user === void 0 ? void 0 : user.survey_complete) || false\n      };\n      await api.user.updateProfile(updateData);\n      await refreshUser();\n      setIsEditing(false);\n      showNotification('success', 'Profile updated successfully!');\n    } catch (error) {\n      console.error('Failed to update profile:', error);\n      showNotification('error', error instanceof Error ? error.message : 'Failed to update profile. Please try again.');\n    }\n  };\n\n  // Update form data when user data changes\n  React.useEffect(() => {\n    if (user) {\n      setFormData({\n        first_name: user.first_name || '',\n        last_name: user.last_name || '',\n        email: user.email || '',\n        age: user.age || '',\n        gender: user.gender || 'not_selected'\n      });\n    }\n  }, [user]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mx-auto px-4 py-8\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-2xl mx-auto\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between mb-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"text-2xl font-bold text-gray-900 dark:text-white\",\n              children: \"Profile Settings\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 167,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setIsEditing(!isEditing),\n              className: \"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg \\r hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500\",\n              children: isEditing ? 'Cancel' : 'Edit Profile'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center mb-6\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative\",\n              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                src: avatarPreview || user.profile_picture || '/default-avatar.svg',\n                alt: \"Profile\",\n                className: \"w-24 h-24 rounded-full object-cover border-4 border-white dark:border-gray-700\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 181,\n                columnNumber: 33\n              }, this), isEditing && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: handleAvatarClick,\n                className: \"absolute bottom-0 right-0 bg-blue-600 text-white p-2 rounded-full \\r hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500\",\n                children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                  xmlns: \"http://www.w3.org/2000/svg\",\n                  className: \"h-4 w-4\",\n                  viewBox: \"0 0 20 20\",\n                  fill: \"currentColor\",\n                  children: /*#__PURE__*/_jsxDEV(\"path\", {\n                    d: \"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 193,\n                    columnNumber: 45\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 192,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 187,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                ref: fileInputRef,\n                type: \"file\",\n                accept: \"image/*\",\n                onChange: handleAvatarChange,\n                className: \"hidden\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 197,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 180,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 25\n          }, this), isEditing ? /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: handleSubmit,\n            className: \"space-y-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-1 md:grid-cols-2 gap-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\",\n                  children: \"First Name\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 211,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  value: formData.first_name,\n                  onChange: e => setFormData({\n                    ...formData,\n                    first_name: e.target.value\n                  }),\n                  className: \"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 \\r rounded-lg shadow-sm focus:outline-none focus:ring-2 \\r focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 214,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 210,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\",\n                  children: \"Last Name\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 224,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  value: formData.last_name,\n                  onChange: e => setFormData({\n                    ...formData,\n                    last_name: e.target.value\n                  }),\n                  className: \"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 \\r rounded-lg shadow-sm focus:outline-none focus:ring-2 \\r focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 227,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 223,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\",\n                children: \"Email\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"email\",\n                value: formData.email,\n                onChange: e => setFormData({\n                  ...formData,\n                  email: e.target.value\n                }),\n                className: \"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 \\r rounded-lg shadow-sm focus:outline-none focus:ring-2 \\r focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 241,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 237,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-1 md:grid-cols-2 gap-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\",\n                  children: \"Age\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 252,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  value: formData.age,\n                  onChange: e => setFormData({\n                    ...formData,\n                    age: e.target.value\n                  }),\n                  min: \"13\",\n                  max: \"120\",\n                  className: \"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 \\r rounded-lg shadow-sm focus:outline-none focus:ring-2 \\r focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 255,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 251,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\",\n                  children: \"Gender\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 267,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                  value: formData.gender,\n                  onChange: e => setFormData({\n                    ...formData,\n                    gender: e.target.value\n                  }),\n                  className: \"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 \\r rounded-lg shadow-sm focus:outline-none focus:ring-2 \\r focus:ring-blue-500 dark:bg-gray-700 dark:text-white\",\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"not_selected\",\n                    children: \"Prefer not to say\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 277,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"male\",\n                    children: \"Male\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 278,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"female\",\n                    children: \"Female\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 279,\n                    columnNumber: 45\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 270,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 266,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-end\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                className: \"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 \\r focus:outline-none focus:ring-2 focus:ring-blue-500\",\n                children: \"Save Changes\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 284,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 283,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 29\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-1 md:grid-cols-2 gap-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"text-sm font-medium text-gray-500 dark:text-gray-400\",\n                  children: \"First Name\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 297,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"mt-1 text-gray-900 dark:text-white\",\n                  children: user.first_name || 'Not set'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 300,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 296,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"text-sm font-medium text-gray-500 dark:text-gray-400\",\n                  children: \"Last Name\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 305,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"mt-1 text-gray-900 dark:text-white\",\n                  children: user.last_name || 'Not set'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 308,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 304,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"text-sm font-medium text-gray-500 dark:text-gray-400\",\n                children: \"Email\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 314,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"mt-1 text-gray-900 dark:text-white\",\n                children: user.email\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 317,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-1 md:grid-cols-2 gap-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"text-sm font-medium text-gray-500 dark:text-gray-400\",\n                  children: \"Age\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 321,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"mt-1 text-gray-900 dark:text-white\",\n                  children: user.age || 'Not set'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 324,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 320,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"text-sm font-medium text-gray-500 dark:text-gray-400\",\n                  children: \"Gender\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 329,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"mt-1 text-gray-900 dark:text-white\",\n                  children: user.gender === 'not_selected' ? 'Prefer not to say' : user.gender ? user.gender.charAt(0).toUpperCase() + user.gender.slice(1) : 'Not set'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 332,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 328,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 319,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 294,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 162,\n    columnNumber: 9\n  }, this);\n};\n_s(Profile, \"DRj7GRWQFcJmhUX/OHByl65Bq4U=\", false, function () {\n  return [useAuth, useNotification];\n});\n_c = Profile;\nexport default Profile;\nvar _c;\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"names":["React","useState","useRef","useAuth","useNotification","api","jsxDEV","_jsxDEV","Profile","_s","user","refreshUser","showNotification","isEditing","setIsEditing","fileInputRef","avatarPreview","setAvatarPreview","formData","setFormData","first_name","last_name","email","age","gender","handleAvatarClick","_fileInputRef$current","current","click","handleAvatarChange","e","_e$target$files","file","target","files","type","startsWith","size","reader","FileReader","onloadend","result","readAsDataURL","FormData","append","token","localStorage","getItem","Error","response","fetch","process","env","REACT_APP_API_URL","method","body","credentials","headers","responseText","text","ok","errorData","JSON","parse","error","console","message","validateForm","trim","includes","parseInt","toString","handleSubmit","preventDefault","updateData","languages","interests","learning_goals","native_language","survey_complete","updateProfile","useEffect","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","src","profile_picture","alt","xmlns","viewBox","fill","d","ref","accept","onChange","onSubmit","value","min","max","charAt","toUpperCase","slice","_c","$RefreshReg$"],"sources":["C:/Custom/Coding/tongly-basic/tongly-basic/frontend/src/pages/Profile.tsx"],"sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { useNotification } from '../contexts/NotificationContext';\r\nimport { api } from '../api/client';\r\nimport { Gender } from '../types';\r\n\r\ninterface FormData {\r\n    first_name: string;\r\n    last_name: string;\r\n    email: string;\r\n    age: string | number;\r\n    gender: Gender;\r\n}\r\n\r\nexport const Profile = () => {\r\n    const { user, refreshUser } = useAuth();\r\n    const { showNotification } = useNotification();\r\n    const [isEditing, setIsEditing] = useState(false);\r\n    const fileInputRef = useRef<HTMLInputElement>(null);\r\n    const [avatarPreview, setAvatarPreview] = useState<string | null>(null);\r\n    const [formData, setFormData] = useState<FormData>({\r\n        first_name: user?.first_name || '',\r\n        last_name: user?.last_name || '',\r\n        email: user?.email || '',\r\n        age: user?.age || '',\r\n        gender: (user?.gender as Gender) || 'not_selected',\r\n    });\r\n\r\n    if (!user) {\r\n        return null;\r\n    }\r\n\r\n    const handleAvatarClick = () => {\r\n        fileInputRef.current?.click();\r\n    };\r\n\r\n    const handleAvatarChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (!file) return;\r\n\r\n        // Validate file type\r\n        if (!file.type.startsWith('image/')) {\r\n            showNotification('error', 'Please select an image file');\r\n            return;\r\n        }\r\n\r\n        // Validate file size (max 5MB)\r\n        if (file.size > 5 * 1024 * 1024) {\r\n            showNotification('error', 'Image size should be less than 5MB');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            // Create preview\r\n            const reader = new FileReader();\r\n            reader.onloadend = () => {\r\n                setAvatarPreview(reader.result as string);\r\n            };\r\n            reader.readAsDataURL(file);\r\n\r\n            // Create form data\r\n            const formData = new FormData();\r\n            formData.append('file', file);\r\n\r\n            // Get token\r\n            const token = localStorage.getItem('token');\r\n            if (!token) {\r\n                throw new Error('No authentication token found');\r\n            }\r\n\r\n            // Upload avatar\r\n            const response = await fetch(`${process.env.REACT_APP_API_URL || 'http://localhost:8080'}/api/profile/avatar`, {\r\n                method: 'POST',\r\n                body: formData,\r\n                credentials: 'include',\r\n                headers: {\r\n                    'Authorization': `Bearer ${token}`,\r\n                }\r\n            });\r\n\r\n            let responseText = await response.text();\r\n            if (!response.ok) {\r\n                try {\r\n                    const errorData = JSON.parse(responseText);\r\n                    throw new Error(errorData.error || 'Failed to upload avatar');\r\n                } catch (e) {\r\n                    throw new Error(responseText || 'Failed to upload avatar');\r\n                }\r\n            }\r\n\r\n            await refreshUser();\r\n            showNotification('success', 'Avatar updated successfully!');\r\n        } catch (error) {\r\n            console.error('Failed to upload avatar:', error);\r\n            showNotification('error', error instanceof Error ? error.message : 'Failed to upload avatar. Please try again.');\r\n            setAvatarPreview(null);\r\n        }\r\n    };\r\n\r\n    const validateForm = () => {\r\n        if (!formData.email.trim()) {\r\n            showNotification('error', 'Email is required');\r\n            return false;\r\n        }\r\n        if (!formData.email.includes('@')) {\r\n            showNotification('error', 'Please enter a valid email address');\r\n            return false;\r\n        }\r\n        if (formData.age && (parseInt(formData.age.toString()) < 13 || parseInt(formData.age.toString()) > 120)) {\r\n            showNotification('error', 'Age must be between 13 and 120');\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        \r\n        if (!validateForm()) {\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const updateData = {\r\n                first_name: formData.first_name.trim() || null,\r\n                last_name: formData.last_name.trim() || null,\r\n                email: formData.email.trim(),\r\n                age: formData.age ? parseInt(formData.age.toString()) : null,\r\n                gender: formData.gender || null,\r\n                // Preserve existing arrays from user data\r\n                languages: user?.languages || [],\r\n                interests: user?.interests || [],\r\n                learning_goals: user?.learning_goals || [],\r\n                native_language: user?.native_language || null,\r\n                survey_complete: user?.survey_complete || false\r\n            };\r\n\r\n            await api.user.updateProfile(updateData);\r\n            await refreshUser();\r\n            setIsEditing(false);\r\n            showNotification('success', 'Profile updated successfully!');\r\n        } catch (error) {\r\n            console.error('Failed to update profile:', error);\r\n            showNotification('error', error instanceof Error ? error.message : 'Failed to update profile. Please try again.');\r\n        }\r\n    };\r\n\r\n    // Update form data when user data changes\r\n    React.useEffect(() => {\r\n        if (user) {\r\n            setFormData({\r\n                first_name: user.first_name || '',\r\n                last_name: user.last_name || '',\r\n                email: user.email || '',\r\n                age: user.age || '',\r\n                gender: (user.gender as Gender) || 'not_selected',\r\n            });\r\n        }\r\n    }, [user]);\r\n\r\n    return (\r\n        <div className=\"container mx-auto px-4 py-8\">\r\n            <div className=\"max-w-2xl mx-auto\">\r\n                <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden\">\r\n                    <div className=\"p-6\">\r\n                        <div className=\"flex items-center justify-between mb-6\">\r\n                            <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n                                Profile Settings\r\n                            </h1>\r\n                            <button\r\n                                onClick={() => setIsEditing(!isEditing)}\r\n                                className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg \r\n                                         hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                            >\r\n                                {isEditing ? 'Cancel' : 'Edit Profile'}\r\n                            </button>\r\n                        </div>\r\n\r\n                        <div className=\"flex items-center mb-6\">\r\n                            <div className=\"relative\">\r\n                                <img\r\n                                    src={avatarPreview || user.profile_picture || '/default-avatar.svg'}\r\n                                    alt=\"Profile\"\r\n                                    className=\"w-24 h-24 rounded-full object-cover border-4 border-white dark:border-gray-700\"\r\n                                />\r\n                                {isEditing && (\r\n                                    <button\r\n                                        onClick={handleAvatarClick}\r\n                                        className=\"absolute bottom-0 right-0 bg-blue-600 text-white p-2 rounded-full \r\n                                                 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                                    >\r\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                                            <path d=\"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z\" />\r\n                                        </svg>\r\n                                    </button>\r\n                                )}\r\n                                <input\r\n                                    ref={fileInputRef}\r\n                                    type=\"file\"\r\n                                    accept=\"image/*\"\r\n                                    onChange={handleAvatarChange}\r\n                                    className=\"hidden\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {isEditing ? (\r\n                            <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                    <div>\r\n                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                            First Name\r\n                                        </label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={formData.first_name}\r\n                                            onChange={(e) => setFormData({ ...formData, first_name: e.target.value })}\r\n                                            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 \r\n                                                     rounded-lg shadow-sm focus:outline-none focus:ring-2 \r\n                                                     focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                        />\r\n                                    </div>\r\n                                    <div>\r\n                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                            Last Name\r\n                                        </label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={formData.last_name}\r\n                                            onChange={(e) => setFormData({ ...formData, last_name: e.target.value })}\r\n                                            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 \r\n                                                     rounded-lg shadow-sm focus:outline-none focus:ring-2 \r\n                                                     focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        Email\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"email\"\r\n                                        value={formData.email}\r\n                                        onChange={(e) => setFormData({ ...formData, email: e.target.value })}\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 \r\n                                                 rounded-lg shadow-sm focus:outline-none focus:ring-2 \r\n                                                 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                    <div>\r\n                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                            Age\r\n                                        </label>\r\n                                        <input\r\n                                            type=\"number\"\r\n                                            value={formData.age}\r\n                                            onChange={(e) => setFormData({ ...formData, age: e.target.value })}\r\n                                            min=\"13\"\r\n                                            max=\"120\"\r\n                                            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 \r\n                                                     rounded-lg shadow-sm focus:outline-none focus:ring-2 \r\n                                                     focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                        />\r\n                                    </div>\r\n                                    <div>\r\n                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                            Gender\r\n                                        </label>\r\n                                        <select\r\n                                            value={formData.gender}\r\n                                            onChange={(e) => setFormData({ ...formData, gender: e.target.value as Gender })}\r\n                                            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 \r\n                                                     rounded-lg shadow-sm focus:outline-none focus:ring-2 \r\n                                                     focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                        >\r\n                                            <option value=\"not_selected\">Prefer not to say</option>\r\n                                            <option value=\"male\">Male</option>\r\n                                            <option value=\"female\">Female</option>\r\n                                        </select>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"flex justify-end\">\r\n                                    <button\r\n                                        type=\"submit\"\r\n                                        className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 \r\n                                                 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                                    >\r\n                                        Save Changes\r\n                                    </button>\r\n                                </div>\r\n                            </form>\r\n                        ) : (\r\n                            <div className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                    <div>\r\n                                        <h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                            First Name\r\n                                        </h3>\r\n                                        <p className=\"mt-1 text-gray-900 dark:text-white\">\r\n                                            {user.first_name || 'Not set'}\r\n                                        </p>\r\n                                    </div>\r\n                                    <div>\r\n                                        <h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                            Last Name\r\n                                        </h3>\r\n                                        <p className=\"mt-1 text-gray-900 dark:text-white\">\r\n                                            {user.last_name || 'Not set'}\r\n                                        </p>\r\n                                    </div>\r\n                                </div>\r\n                                <div>\r\n                                    <h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                        Email\r\n                                    </h3>\r\n                                    <p className=\"mt-1 text-gray-900 dark:text-white\">{user.email}</p>\r\n                                </div>\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                    <div>\r\n                                        <h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                            Age\r\n                                        </h3>\r\n                                        <p className=\"mt-1 text-gray-900 dark:text-white\">\r\n                                            {user.age || 'Not set'}\r\n                                        </p>\r\n                                    </div>\r\n                                    <div>\r\n                                        <h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                            Gender\r\n                                        </h3>\r\n                                        <p className=\"mt-1 text-gray-900 dark:text-white\">\r\n                                            {user.gender === 'not_selected' \r\n                                                ? 'Prefer not to say' \r\n                                                : user.gender ? user.gender.charAt(0).toUpperCase() + user.gender.slice(1) : 'Not set'}\r\n                                        </p>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Profile; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}